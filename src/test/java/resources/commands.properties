
lambda_grant_s3_invoke_permission= awslocal lambda add-permission --function-name shipment-picture-lambda-validator --statement-id s3-invoke --action "lambda:InvokeFunction" --principal s3.amazonaws.com --source-arn arn:aws:s3:::shipment-picture-bucket
add_lambda_env_vars= awslocal lambda update-function-configuration --function-name shipment-picture-lambda-validator --region eu-central-1 --environment "Variables={TEST_ACCESS_KEY_LOCAL=test_access_key,TEST_SECRET_ACCESS_KEY_LOCAL=test_secret_access_key,S3_ENDPOINT_LOCAL=https://s3.localhost.localstack.cloud:4566,REGION_LOCAL = eu-central-1}"
s3_bucket_add_notif_config= awslocal s3api put-bucket-notification-configuration --bucket shipment-picture-bucket --notification-configuration ${s3_notif_config}
s3_notif_config= "{\"LambdaFunctionConfigurations\":[{\"Id\":\"shipment-picture-lambda-validator\",\"LambdaFunctionArn\":\"arn:aws:lambda:eu-central-1:000000000000:function:shipment-picture-lambda-validator\",\"Events\":[\"s3:ObjectCreated:*\"]}]}"

create_sns= awslocal sns create-topic --name update_shipment_picture_topic
create_sqs=awslocal sqs create-queue --queue-name update_shipment_picture_queue
sqs_subscribe_to_sns=awslocal sns subscribe --topic-arn $(aws sns list-topics --query "Topics[0].TopicArn" --output text) --protocol sqs --notification-endpoint $(aws sqs get-queue-url --queue-name update_shipment_picture_queue --query "QueueUrl" --output text)
